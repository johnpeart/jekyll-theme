---
layout: default
---
	
{% include header.html %}
		
<main id="content" class="container">

	{% assign totalgoalmax = 0 %}
	{% assign totalgoalprogress = 0 %}
	{% assign goalno = 0 %}
	{% assign totalgoalpercentage = 0 %}
	{% assign dayoftheyear = "now" | date: "%j" %}
	{% assign currentyear = "now" | date: "%Y" | plus: 0 %}

	{% if page.year %}
	{% assign goalsdata = "goals-" | append: page.year %}
	{% else %}
	{% assign goalsdata = "goals-" | append: currentyear %}
	{% endif %}

	<section id="page-content">

		<h1 id="site-heading">{{ site.title }}</h1>
		
		{% if page.year %}
		{% if currentyear != page.year %}

			<blockquote>
				<p>These were my goals for {{ page.year }}.</p>
			</blockquote>

		{% endif %}
		{% endif %}

			<ul id="goals-list">
			
				{% for goals in site.data[goalsdata] %}
										
					<li>
								
						<h2>{{ goals.goal }}</h2>
						<p class="lead">{{ goals.description }}</p>

						{% if goals.stretch %}
							<progress class="standard" max="{{ goals.max }}" value="{{ goals.progress }}">
								<p><strong>{{ goals.progress | remove: ".0" }}</strong> out of an initial goal of <strong>{{ goals.max | remove: ".0" }}</strong></p>
							</progress>
							{% if goals.stretch > 0.0 %}
								<progress class="stretch" max="{{ goals.stretch }}" value="{{ goals.progress | minus: goals.max | at_least: 0 }}">
									<p><strong>{{ goals.progress | minus: goals.max | remove: ".0" | at_least: 0 }}</strong> out of a stretch goal of <strong>{{ goals.stretch | remove: ".0" }}</strong></p>
								</progress>
							{% endif %}
						{% else %}
							<progress max="{{ goals.max }}" value="{{ goals.progress }}">
								<p><strong>{{ goals.progress | remove: ".0" }}</strong> out of <strong>{{ goals.max | remove: ".0" }}</strong></p>
							</progress>
						{% endif %}
								
						{% if goals.comment != "" %}<p>{{ goals.comment }}</p>{% endif %}
					
					</li>
							
					{% assign goalvalue = goals.progress | divided_by: goals.max | times: 100 %}

					<!-- debugging output -->
					<!-- Goal description: {{ goals.description }} -->
					<!-- Goal value: {{ goalvalue }} = Goal progress: {{ goals.progress }} | divided_by: Goal max: {{ goals.max }} | times: 100 -->

					{% capture totalgoalmax %}{{ totalgoalmax | plus: goals.max | floor }}{% endcapture %}
					{% capture totalgoalprogress %}{{ totalgoalprogress | plus: goals.progress }}{% endcapture %}
					{% if goalvalue >= 80 %}
						{% capture totalgoalpercentage %}{{ totalgoalpercentage | plus: 100 | floor }}{% endcapture %}
					<!-- Goal value greater than or equal to 80% so goal percentage set to {{ totalgoalpercentage }} -->
					{% else %}
						{% capture totalgoalpercentage %}{{ totalgoalpercentage | plus: goalvalue | floor }}{% endcapture %}
					<!-- Goal value less than 80% so goal percentage set to {{ totalgoalpercentage }} -->
					{% endif %}
					{% capture goalno %}{{ goalno | plus: 1 }}{% endcapture %}
					<!-- Goal number {{goalno }} complete -->
				
				{% endfor %}	
								

				
				<li class="totaliser">
					<h2>Overall progress</h2>
					<p class="lead">Goal completion</p>
					<progress max="100" value="{{ totalgoalpercentage | divided_by: goalno }}">
						<p><strong>{{ totalgoalpercentage | divided_by: goalno | floor }}% of goals completed (each goal given equal weighting)</strong></p>
					</progress>
					<p>{{ totalgoalpercentage | divided_by: goalno | floor }}% of goals completed (each goal given equal weighting)</p>
					
					{% if goalsdata contains currentyear %}
					<p class="lead">Year to date</p>
					<progress max="365" value="{{ dayoftheyear }}">
						<p>Day <strong>{{ dayoftheyear }}</strong> out of <strong>365</strong></p>
					</progress>
					<p>Progress against my goals was last updated on the {{ "now" | date: "%-d %B" }}.</p>
					{% endif %}
				</li>
							
			</ul>

							
	</section>
	
</main>

{% include footer.html %}